<split-panel-container>
    <div>
        <div class="page-body">
            <form #pageForm="ngForm" (ngSubmit)="saveAction()" class="form-horizontal">

                <!-- ENVIRONMENT -->
                <div class="my-line">
                    <label class="my-label label-size col-form-label" for="environment">Environment to test</label>

                    <div class="my-value" *ngIf="!isEditMode">
                        {{model.environment || ""}}
                    </div>
                    <div class="my-value" *ngIf="isEditMode">
                        <input id="environment" required
                               #environment="ngModel" [(ngModel)]="model.environment"
                               type="text" class="form-control" name="environment">
                        <div *ngIf="environment.errors && (environment.dirty || environment.touched)"
                             class="alert alert-danger">
                            <div [hidden]="!environment.errors.required">
                                Environment to test name is required
                            </div>
                        </div>
                    </div>
                </div>

                <!-- APPLICATION VERSION -->
                <div class="my-line">
                    <label class="my-label label-size col-form-label" for="applicationVersion">Application version</label>

                    <div class="my-value" *ngIf="!isEditMode">
                        {{model.applicationVersion || ""}}
                    </div>
                    <div class="my-value" *ngIf="isEditMode">
                        <input id="applicationVersion" required
                               #applicationVersion="ngModel" [(ngModel)]="model.applicationVersion"
                               type="text" class="form-control" name="applicationVersion">
                        <div *ngIf="applicationVersion.errors && (applicationVersion.dirty || applicationVersion.touched)"
                             class="alert alert-danger">
                            <div [hidden]="!applicationVersion.errors.required">
                                Application Version to test is required
                            </div>
                        </div>
                    </div>
                </div>

                <div class="display-row-container" *ngIf="!isEditMode">
                    <p-chart type="pie" [responsive]="false" height="400px" width="400px" [data]="pieChartData" ></p-chart>

                    <json-tree [treeModel]="executorTestsTreeService.testsJsonTreeModel"
                               [modelComponentMapping]="executorTestsComponentMapping">
                    </json-tree>
                </div>

                <div class="display-row-container" *ngIf="isEditMode">
                    <manual-select-tests-tree [model]="model" [isEditMode]="isEditMode"></manual-select-tests-tree>
                </div>

                <!-- ACTION BUTTONS -->
                <div class="panel-footer-button">

                    <ng-container *ngIf="isFinalized">
                        <button (click)="deleteAction();" type="button" class="btn btn-danger">Delete</button>
                        <button (click)="bringBackInExecution();" type="button" class="btn btn-warning">Back To Execution</button>
                    </ng-container>

                    <ng-container *ngIf="!isEditMode && !isFinalized">
                        <button (click)="enableEditTestMode();" type="button" class="btn btn-primary">Edit</button>
                        <button (click)="navigateToExecutorMode();" type="button" class="btn btn-success">Execute</button>
                    </ng-container>
                    <ng-container *ngIf="isEditMode">
                        <button (click)="cancelAction();" type="button" class="btn btn-default">Cancel</button>
                        <button *ngIf="!isCreateAction" (click)="deleteAction();" type="button" class="btn btn-danger">Delete</button>
                        <button *ngIf="!isCreateAction" (click)="finalize();" type="button" class="btn btn-warning">Finalize</button>
                        <button [disabled]="!pageForm.form.valid" class="btn btn-primary">Save</button>
                    </ng-container>
                </div>
            </form>
        </div>
    </div>
    <are-you-sure-modal #areYouSureModalComponent></are-you-sure-modal>
</split-panel-container>
